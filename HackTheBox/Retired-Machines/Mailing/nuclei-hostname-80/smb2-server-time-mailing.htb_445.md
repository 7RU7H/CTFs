### SMB2 Server Time - Detection (smb2-server-time) found on mailing.htb:445

----
**Details**: **smb2-server-time** matched at mailing.htb:445

**Protocol**: JAVASCRIPT

**Full URL**: mailing.htb:445

**Timestamp**: Sun May 5 17:42:46 +0100 BST 2024

**Template Information**

| Key | Value |
| --- | --- |
| Name | SMB2 Server Time - Detection |
| Authors | dhiyaneshdk |
| Tags | js, network, smb, enum |
| Severity | info |
| Description | Trying to retrieve the present date of the system along with the initiation date of an SMB2 server.<br> |
| shodan-query | port:445 |

**Request**
```http
var m = require("nuclei/smb");
var c = m.SMBClient();
var response = c.ConnectSMBInfoMode(Host, Port);
var systemTime = new Date(response.NegotiationLog.SystemTime * 1000).toISOString();
var serverstartTime = new Date(response.NegotiationLog.ServerStartTime * 1000).toISOString();
var result = "SystemTime: " + systemTime + " ServerStartTime: " + serverstartTime;
result
```

**Response**
```http
SystemTime: 2024-05-05T16:42:46.000Z ServerStartTime: 2009-04-22T19:24:48.000Z
```

**Extra Information**

**Extracted results:**

- SystemTime: 2024-05-05T16:42:46.000Z ServerStartTime: 2009-04-22T19:24:48.000Z


References: 
- https://nmap.org/nsedoc/scripts/smb2-time.html

----

Generated by [Nuclei v3.2.2](https://github.com/projectdiscovery/nuclei)