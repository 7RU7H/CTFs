### smb2-capabilities - Enumeration (smb2-capabilities) found on internal.analysis.htb:445

----
**Details**: **smb2-capabilities** matched at internal.analysis.htb:445

**Protocol**: JAVASCRIPT

**Full URL**: internal.analysis.htb:445

**Timestamp**: Thu Jan 25 14:07:17 +0000 GMT 2024

**Template Information**

| Key | Value |
| --- | --- |
| Name | smb2-capabilities - Enumeration |
| Authors | pussycat0x |
| Tags |  |
| Severity | info |
| Description | Attempts to list the supported capabilities in a SMBv2 server for each enabled dialect.<br> |
| shodan-query | port:445 |

**Request**
```http
var m = require("nuclei/smb");
var c = m.SMBClient();
var response = c.ConnectSMBInfoMode(Host, Port);
to_json(response);
```

**Response**
```http
{
  "SupportV1": false,
  "Version": {
    "Major": 2,
    "Minor": 1,
    "Revision": 0,
    "VerString": "SMB 2.1"
  },
  "NativeOs": "",
  "NTLM": "",
  "GroupName": "",
  "Capabilities": {
    "DFSSupport": true,
    "Leasing": true,
    "LargeMTU": true,
    "MultiChan": false,
    "Persist": false,
    "DirLeasing": false,
    "Encryption": false
  },
  "HasNTLM": true,
  "NegotiationLog": {
    "HeaderLog": {
      "ProtocolID": [
        0,
        0,
        0,
        0,
        254,
        83,
        77,
        66
      ],
      "Status": 0,
      "Command": 0,
      "Credits": 1,
      "Flags": 1
    },
    "ProtocolID": [
      0,
      0,
      0,
      0,
      254,
      83,
      77,
      66
    ],
    "Status": 0,
    "Command": 0,
    "Credits": 1,
    "Flags": 1,
    "SecurityMode": 3,
    "DialectRevision": 528,
    "ServerGuid": [
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      53,
      19,
      74,
      17,
      130,
      212,
      18,
      64,
      162,
      206,
      193,
      124,
      231,
      152,
      158,
      131
    ],
    "Capabilities": 7,
    "SystemTime": 1706191620,
    "ServerStartTime": 1240428288,
    "AuthenticationTypes": [
      "1.3.6.1.4.1.311.2.2.30",
      "1.2.840.48018.1.2.2",
      "1.2.840.113554.1.2.2",
      "1.2.840.113554.1.2.2.3",
      "1.3.6.1.4.1.311.2.2.10"
    ]
  },
  "SessionSetupLog": {
    "HeaderLog": {
      "ProtocolID": [
        0,
        0,
        0,
        0,
        254,
        83,
        77,
        66
      ],
      "Status": 3221225494,
      "Command": 1,
      "Credits": 1,
      "Flags": 1
    },
    "ProtocolID": [
      0,
      0,
      0,
      0,
      254,
      83,
      77,
      66
    ],
    "Status": 3221225494,
    "Command": 1,
    "Credits": 1,
    "Flags": 1,
    "SetupFlags": 0,
    "TargetName": "ANALYSIS",
    "NegotiateFlags": 2726887941
  }
}
```

**Extra Information**

**Extracted results:**

- ["DFSSupport","LargeMTU","Leasing"]


References: 
- https://nmap.org/nsedoc/scripts/smb2-capabilities.html

----

Generated by [Nuclei v3.1.4](https://github.com/projectdiscovery/nuclei)