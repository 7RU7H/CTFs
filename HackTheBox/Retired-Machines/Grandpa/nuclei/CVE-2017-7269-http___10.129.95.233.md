### Windows Server 2003 & IIS 6.0 - Remote Code Execution (CVE-2017-7269) found on http://10.129.95.233
---
**Details**: **CVE-2017-7269**  matched at http://10.129.95.233

**Protocol**: HTTP

**Full URL**: http://10.129.95.233

**Timestamp**: Thu May 26 21:48:14 +0100 BST 2022

**Template Information**

| Key | Value |
|---|---|
| Name | Windows Server 2003 & IIS 6.0 - Remote Code Execution |
| Authors | thomas_from_offensity, geeknik |
| Tags | cve, cve2017, rce, windows, iis |
| Severity | critical |
| Description | Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 contains a buffer overflow vulnerability in the ScStoragePathFromUrl function in the WebDAV service that could allow remote attackers to execute arbitrary code via a long header beginning with "If <http://" in a PROPFIND request.
 |
| CVSS-Metrics | [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| CWE-ID | [CWE-119](https://cwe.mitre.org/data/definitions/119.html) |
| CVE-ID | [CVE-2017-7269](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2017-7269) |
| CVSS-Score | 9.80 |

**Request**
```http
OPTIONS / HTTP/1.1
Host: 10.129.95.233
User-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2049.0 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip


```

**Response**
```http
HTTP/1.1 200 OK
Connection: close
Accept-Ranges: none
Allow: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK
Cache-Control: private
Dasl: <DAV:sql>
Date: Thu, 26 May 2022 20:48:14 GMT
Dav: 1, 2
Microsoftofficewebserver: 5.0_Pub
Ms-Author-Via: MS-FP/4.0,DAV
Public: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH
Server: Microsoft-IIS/6.0
X-Powered-By: ASP.NET
Content-Length: 0


```

References: 
- https://blog.0patch.com/2017/03/0patching-immortal-cve-2017-7269.html
- https://github.com/danigargu/explodingcan/blob/master/explodingcan.py
- https://nvd.nist.gov/vuln/detail/cve-2017-7269
- https://github.com/edwardz246003/iis_exploit

**CURL Command**
```
curl -X 'OPTIONS' -d '' -H 'Accept: */*' -H 'Accept-Language: en' -H 'User-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2049.0 Safari/537.36' 'http://10.129.95.233'
```
---
Generated by [Nuclei 2.7.1](https://github.com/projectdiscovery/nuclei)