(function(){var b=$("#device-list-widget"),e=true;function c(f){var h=0,g=0;f.forEach(function(i){if(i.isOnline()){if(e&&i.isGuest()){g++}else{h++}}});b.find("#lnkCurrent").text(h);b.find("#lnkCurrentGuests").text(g)}function a(f,h){var g=RAINIER.connect.AppletManager.getAppletById("691E0149-A1D4-450C-9922-82CAA65B16C0");if(g){if(f){RAINIER.ui.MainMenu.launchApplet(g,"","add-device")}else{RAINIER.ui.MainMenu.launchApplet(g,h)}}else{console.warn("Widget: cannot locate Device List applet")}}function d(){b.find(".app-link").bind("click",function(){a(false,"")});b.find(".app-link-guests").bind("click",function(){a(false,"known-guests")});b.find("#btnAddDevice").bind("click",function(){a(true)});var f=b.find("#btnAddDevice");f.attr("tooltip",f.text());RAINIER.ui.tooltip.add(f,"top");RAINIER.deviceManager.getDevices(c,null);RAINIER.event.connect(["devices.revisionUpdated","devices.guestNetworkUpdated","guestNetwork.updated"],function(){RAINIER.deviceManager.getDevices(c,null)});RAINIER.event.connect("guestNetwork.updated",function(g,h){e=h.isGuestNetworkEnabled;RAINIER.deviceManager.getDevices(c,null)})}d()}());