window.RAINIER=window.RAINIER||{};RAINIER.applets=RAINIER.applets||{};RAINIER.applets.USBStorage=RAINIER.applets.USBStorage||(function(){var d=true;function a(){g()}function g(i){if(RAINIER.shared.util.areServicesSupported(["/jnap/storage/StorageInfo"])){RAINIER.jnap.send({action:"/jnap/storage/GetStorageCapabilities",data:{},cb:function(j){if(j.result==="OK"){d=j.output.isVUSBDriverInstalled;if(typeof i==="function"){i(j.output)}}}})}else{if(typeof i==="function"){i({})}}}function f(){return d}function c(){return RAINIER.shared.util.areServicesSupported(["/jnap/storage/UPnPMediaServer"])}function h(i){var l=["B","kB","MB","GB","TB"],j=0,k=0;if(i>0){j=Math.floor(Math.log(i)/Math.log(1024));k=(i/Math.pow(1024,j)).toFixed(2)*1}return k+" "+l[j]}function e(m,j){function i(o){function q(u){return u*0.0009765625}var t=0,p="";var s=q(o);if(s>=1){var r=q(s);if(r>=1){var n=q(r);if(n>=1){t=n.toFixed(2);p=RAINIER.ui.common.strings.usb.TB}else{t=r.toFixed(2);p=RAINIER.ui.common.strings.usb.GB}}else{t=Math.round(s);p=RAINIER.ui.common.strings.usb.MB}}else{t=o;p=RAINIER.ui.common.strings.usb.KB}return{val:t,unit:p}}var k=i(m);var l=i(m+j);return RAINIER.ui.common.strings.usb.usedSpaceFmt.format(k.val.toString(),k.unit,l.val.toString(),l.unit)}function b(n,m,o){var p=[];for(var l=0;l<n.length;l++){for(var k=0;k<m.length;k++){if(o(n[l],m[k])){p.append(n[l]);break}}}return p}return{initialize:a,getStorageCapabilities:g,isVUSBDriverInstalled:f,mediaServerSupported:c,humanFileSize:h,computeUsedSpaceLabel:e,intersectArray:b}}());