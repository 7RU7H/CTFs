(function(){var e=$("#add-a-device"),i=$("#networkmap-applet"),a="7B1F462B-1A78-4AF6-8FBB-0C221703BEA4",g=false,b={wireless:{radios:[]}};var j={"labels.short":"display-only","labels.band":"display-only"};var m={onAddDeviceButtonClick:function(){RAINIER.event.fire("Add Device Button Pressed");m.onAddDeviceClick()},onAddDeviceClick:function(){RAINIER.applets.devicelist.unfoldSection(e);f(e.find("#add-device-container"));c()},onCancelClick:function(){h()},onAddComputerClick:function(){f(e.find("#add-computer-container"))},onComputerOkClick:function(){RAINIER.event.fire("New Device Connected");h()},onAddWPSClick:function(){i.find("header .close-button").click();RAINIER.ui.showWaiting();setTimeout(function(){RAINIER.ui.hideWaiting();var n=RAINIER.connect.AppletManager.getAppletById(a);if(n){RAINIER.ui.MainMenu.launchApplet(n,"wps")}else{console.warn("add-device.js: cannot locate Wireless applet")}},500)},onAddOtherClick:function(){f(e.find("#add-other-container"))},onOtherOkClick:function(){RAINIER.event.fire("New Device Connected");h()},onAddUSBPrinterClick:function(){f(e.find("#add-usb-printer-container"))}};function h(){RAINIER.applets.devicelist.foldSection(e)}function f(n){e.children("section").css("display","none");n.css("display","block")}function d(){RAINIER.jnap.send({action:RAINIER.jnapActions.getRadioInfo(),data:{},cb:function(n){b.wireless=n.output||{};if(n.result==="OK"){RAINIER.applets.wireless.sortRadios(b.wireless.radios);l()}}})}function c(){if(g){return}g=true;e.find("footer>button.cancel").click(m.onCancelClick);var n=e.find("#add-device-container");n.find("#add-computer").click(m.onAddComputerClick);n.find("#add-wps").click(m.onAddWPSClick);n.find("#add-other").click(m.onAddOtherClick);if(RAINIER.shared.util.areServicesSupported(["/jnap/storage/Storage"])&&RAINIER.applets.USBStorage.isVUSBDriverInstalled()){n.find("#add-usb-printer").click(m.onAddUSBPrinterClick)}else{n.find("#add-usb-printer").hide();n.find("#usb-printer-text").hide()}n.find(".back").click(m.onCancelClick);n=e.find("#add-computer-container");n.find(".back").click(m.onAddDeviceClick);n.find(".submit").click(m.onComputerOkClick);n.find(".cancel").click(m.onCancelClick);n=e.find("#add-other-container");n.find(".back").click(m.onAddDeviceClick);n.find(".submit").click(m.onOtherOkClick);n=e.find("#add-usb-printer-container");n.find(".back").click(m.onAddDeviceClick)}function l(){var q={settings:{ssid:RAINIER.ui.strings.deviceList.networkNotEnabled,wpaPersonalSettings:{passphrase:""},security:""}};var o=RAINIER.ui.template.createTemplate($("#radio-settings-template > div")),n=null,p=null;$.each(b.wireless.radios,function(s,r){if(r.settings.isEnabled){p=RAINIER.shared.util.getLabeledRadio(b.wireless,r.radioID)}else{p=q}if(RAINIER.applets.wireless.shouldFilterRadio(p,b.wireless)){p.securityText=RAINIER.ui.common.strings.wirelessSecurity[p.settings.security];RAINIER.applets.wireless.setDisplayWepKey(p);n=RAINIER.ui.template.createBlock(o,p,j);n.find(".wireless-hide-row").hide();if(p.settings.security==="WEP"){n.find("#key-row").show()}else{if(p.settings.security==="WPA-Enterprise"||p.settings.security==="WPA2-Enterprise"||p.settings.security==="WPA-Mixed-Enterprise"){n.find("#shared-key-row").show()}else{if(["","None","Enhanced-Open","Enhanced-Open-Only","Enhanced-Open+None"].indexOf(p.settings.security)===-1){n.find("#password-row").show()}}}i.find(".settings-container-wrapper").append(n)}});if($.cookie("app-flag")==="add-device"){i.find("#show-add-a-device").click()}}function k(){i.find("#show-add-a-device").click(m.onAddDeviceButtonClick);d();RAINIER.event.fire("Add Device Loaded")}k()}());