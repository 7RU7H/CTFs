(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","./symmetry-jnap","./symmetry-util"],b)}else{if(typeof module==="object"&&module.exports){module.exports=b(require("jquery"),require("./symmetry-jnap"),require("./symmetry-util"))}else{a.validation=b(a.$,a.JNAP,a.symmetryUtil)}}}(this,function(h,o,q){var m={DHCP:{min:576,max:1500},Static:{min:576,max:1500},PPPoE:{min:576,max:1492},PPTP:{min:576,max:1460},L2TP:{min:576,max:1460}};function f(w,v){var u=RegExp(v);return !w||u.test(w)}function c(w,v){var u=RegExp(v);return !w||!u.test(w)}function t(u){return function(v){return f(v,u)}}function n(w,x){if(!x||!x.guestPasswordRestrictions){return true}var v="";h.each(x.guestPasswordRestrictions.allowedCharacters,function(){v+="\\x"+this.lowCodepoint.toString(16).toUpperCase()+"-\\x"+this.highCodepoint.toString(16).toUpperCase()});var u=t("^["+v+"]+$");return u(w)}var l,k;l={minLength:function(v,u){return !v||v.length>=u},maxLength:function(v,u){v=v||"";return v.length<=u},rangeFirstPortValid:function(v,u){if(!u&&u!==0){return true}return k.max.fn(v,u)},rangeLastPortValid:function(u,v){if(!v&&v!==0){return true}return k.min.fn(u,v)},ipAddressHasFourOctets:function(u){return !u||u.split(".").length===4},ipAddressLocalTestSubnetMask:function(v,u){if(!v){return true}return b(v,u.ipAddress,u.subnetMask)},ipAddressLocalNotRouterIp:function(y,w){if(!y){return true}var u=y.split(".");var x=w.ipAddress.split(".");for(var v=0;v<4;v++){if(x[v]!==u[v]){return true}}return false},maxUsersValid:function(v,u){if(!v){return true}return v<=u.dhcpSettings.maxUsersLimit},wirelessSecurityTestMode:function(v,w){var u=w.settings.mode;if(q.wireless.isMixedMode(u,w)){return true}return !((u.indexOf("n")>-1||u.indexOf("ac")>-1)&&(v==="WEP"||v==="WPA-Mixed-Personal"||v==="WPA-Mixed-Enterprise"))},wirelessSecurityTestChannelWidth:function(v,w){var u=w.settings.channelWidth;return !(v==="WEP"&&q.wireless.isWideChannel(u))},networkModeTestSecurity:function(v,w){if(q.wireless.isMixedMode(v,w)){return true}var u=w.settings.security;v=v||"";return !((v.indexOf("n")>-1||v.indexOf("ac")>-1)&&(u==="WEP"||u==="WPA-Mixed-Personal"||u==="WPA-Mixed-Enterprise"))},networkModeTestChannelWidth:function(x,y){if(q.wireless.isMixedMode(x,y)){return true}x=x||"";var w=y.settings.channelWidth;var v=!(q.wireless.isWideChannel80or160(w)&&x.indexOf("ac")===-1);var u=!(x==="802.11a"&&q.wireless.isWideChannel(w));return v&&u},channelWidthTestSecurity:function(v,w){v=v||"";var u=w.settings.security;return !(q.wireless.isWideChannel(v)&&(u==="WEP"))},channelWidthTestMode:function(x,y){x=x||"";var w=y.settings.mode;var v=!(q.wireless.isWideChannel(x)&&(w==="802.11a"));var u=!(q.wireless.isWideChannel80or160(x)&&(w.indexOf("ac")===-1));return v&&u},channelWidthTestChannel:function(v,w){var u=w.settings.channel;return q.wireless.isChannelAndWidthSupported(u,v,w)},channelTestWidth:function(v,w){var u=w.settings.channelWidth;return !v||q.wireless.isChannelAndWidthSupported(v,u,w)},ssidTestNoCollision:function(w,x){var u=x.guestnetwork||{},v;if(u.isGuestNetworkEnabled){if(u.guestSSID){if(u.guestSSID===w){return false}}else{for(v=0;v<u.radios.length;v++){if(u.radios[v].isEnabled&&u.radios[v].guestSSID===w){return false}}}}return true},guestSsidTestNoCollision:function(x,u){var w=u.wirelessap||{radios:[]},v;for(v=0;v<w.radios.length;v++){if(w.radios[v].settings.ssid===x){return false}}return true},subnetMaskValid:function(x,w){var v=w?w.minNetworkPrefixLength:null,u=w?w.maxNetworkPrefixLength:null;if(!x){return true}return q.ip.isValidSubnetMask(x,v,u)},mtuValid:function(w,x){var v=parseInt(w,10),u=x.wanType;if(!w){return true}if(v===0||(v>=m[u].min&&v<=m[u].max)){return true}return false},macAddressValid:function(w){if(!w){return true}if(!/^(?:[0-9a-f]{2}[:-]?){5}(?:[0-9a-f]{2})$/i.test(w)){return false}if(w==="00:00:00:00:00:00"){return false}var x=w.substr(0,2),u=parseInt(x,16).toString(2);if(u.substr(u.length-1)==="1"){return false}var v=x.substr(x.length-1).toUpperCase();if(["0","2","4","6","8","A","C","E"].indexOf(v)===-1){return false}return true},vlanIDValid:function(v){if(!v){return true}var u=parseInt(v,10);if(u>=3&&u<=4095){return true}return false}};k={required:{fn:function(u){return Boolean(u)},message:"{{You must enter something to continue.}}",display:"onBlur"},min:{fn:function(v,u){return !v||parseFloat(v)>=u},message:"{{Must be {0} or greater.}}",display:"onBlur"},max:{fn:function(v,u){return !v||parseFloat(v)<=u},message:"{{Must be {0} or smaller.}}",display:"dynamic"},minLength:{fn:l.minLength,message:"{{Must be {0} characters or more.}}",display:"onBlur"},maxLength:{fn:l.maxLength,message:"{{Can't exceed {0} characters.}}",display:"dynamic"},pattern:{fn:function(v,u){return f(v,u)},message:"{{Invalid character.}}",display:"onBlur"},noSurroundWhitespace:{fn:function(u){return c(u,/^\s+|\s+$/)},message:"{{Can't start and/or end with a space.}}",display:"dynamic"},noSurroundDot:{fn:function(u){return c(u,/^\.+|\.+$/)},message:"{{Please enter a valid domain like: Facebook.com .}}",display:"onBlur"},integer:{fn:t(/^([0-9]+)$/),message:"{{Should be all numbers.}}",display:"dynamic"},macAddress:{fn:l.macAddressValid,message:'{{Must be twelve [0-9,a-f] characters only; ":" and "-" are optional.}}',display:"onBlur"},email:{fn:t(/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/),message:"{{Enter a complete email address.}}",display:"onBlur"},ascii:{fn:t(/^[\x20-\x7E]+$/),message:"{{Use letters, numbers, and common symbols.}}",display:"dynamic"},guestPasswordAllowedCharacters:{fn:n,message:"{{Use letters and numbers.}}",display:"dynamic"},hex:{fn:t(/^[0-9A-Fa-f]+$/),message:"{{Use numbers (0-9) and letters (a-f).}}",display:"dynamic"},rangeFirstPortValid:{fn:l.rangeFirstPortValid,message:"{{Beginning port number must be smaller or equal to ending port number.}}",display:"dynamic"},rangeLastPortValid:{fn:l.rangeLastPortValid,message:"{{Beginning port number must be smaller or equal to ending port number.}}",display:"dynamic"},ipAddressHasFourOctets:{fn:l.ipAddressHasFourOctets,message:"{{IP addresses are 4 octets separated by dots.}}",display:"onBlur"},ipAddress1stOctet:{fn:s(0,1,254),message:"{{First octet must be a number between 1-254.}}",display:"dynamic"},ipAddress1stOctetRouter:{fn:s(0,1,223),message:"{{First octet must be a number between 1-223.}}",display:"dynamic"},ipAddress2ndOctet:{fn:s(1),message:"{{Second octet must be a number between 0-255.}}",display:"dynamic"},ipAddress3rdOctet:{fn:s(2),message:"{{Third octet must be a number between 0-255.}}",display:"dynamic"},ipAddress4thOctet:{fn:s(3),message:"{{Fourth octet must be a number between 0-255.}}",display:"dynamic"},subnet1stOctet:{fn:s(0),message:"{{Invalid Subnet Mask.}}",display:"dynamic"},subnet2ndOctet:{fn:s(1),message:"{{Invalid Subnet Mask.}}",display:"dynamic"},subnet3rdOctet:{fn:s(2),message:"{{Invalid Subnet Mask.}}",display:"dynamic"},subnet4thOctet:{fn:s(3),message:"{{Invalid Subnet Mask.}}",display:"dynamic"},ipAddressNotReserved:{fn:function(u){return u!=="0.0.0.0"&&u!=="127.0.0.1"&&u!=="255.255.255.255"},message:"{{This IP address is already reserved.}}",display:"onBlur"},ipAddressPattern:{fn:t(/^\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/),message:"{{Invalid IP address.}}",display:"onBlur"},ipAddressLocalTestSubnetMask:{fn:l.ipAddressLocalTestSubnetMask,message:"{{This IP address is not in valid subnet.}}",display:"onBlur"},ipAddressLocalNotRouterIp:{fn:l.ipAddressLocalNotRouterIp,message:"{{Can't use router IP address.}}",display:"onBlur"},ssidTestNoCollision:{fn:l.ssidTestNoCollision,message:"{{Main network SSID cannot be the same as an active guest network SSID.}}",display:"onBlur"},guestSsidTestNoCollision:{fn:l.guestSsidTestNoCollision,message:"{{Guest network SSID cannot be the same as a main network SSID.}}",display:"onBlur"},domainCharsOnly:{fn:a([".."," ",":","/","?","#","[","]","@","!","$","&","'","(",")","*","+",",",";","="]),message:"{{Please enter a valid domain like: Facebook.com .}}",display:"onBlur"},dotRequired:{fn:function(u){return !u||u.indexOf(".")!==-1},message:"{{Please enter a valid domain like: Facebook.com .}}",display:"onBlur"},wirelessSecurityTestMode:{fn:l.wirelessSecurityTestMode,message:"{{Invalid when network mode is n or ac.}}",display:"onBlur"},wirelessSecurityTestChannelWidth:{fn:l.wirelessSecurityTestChannelWidth,message:"{{Invalid in wide channels.}}",display:"onBlur"},networkModeTestSecurity:{fn:l.networkModeTestSecurity,message:"{{Invalid when security type is WEP or WPA-Mixed.}}",display:"onBlur"},networkModeTestChannelWidth:{fn:l.networkModeTestChannelWidth,message:"{{Invalid for selected channel width.}}",display:"onBlur"},channelWidthTestSecurity:{fn:l.channelWidthTestSecurity,message:"{{Invalid when security type is WEP.}}",display:"onBlur"},channelWidthTestMode:{fn:l.channelWidthTestMode,message:"{{Invalid for selected network mode.}}",display:"onBlur"},channelWidthTestChannel:{fn:l.channelWidthTestChannel,message:"{{Not supported for selected channel.}}",display:"onBlur"},channelTestWidth:{fn:l.channelTestWidth,message:"{{Not supported for selected channel width.}}",display:"onBlur"},subnetMask:{fn:l.subnetMaskValid,message:"{{Invalid Subnet Mask.}}",display:"onBlur"},mtuValid:{fn:l.mtuValid,message:"{{MTU invalid for current WAN type.}}",display:"onBlur"},vlanIDValid:{fn:l.vlanIDValid,message:"{{Value is out of range (3-4095).}}",display:"onBlur"},maxUsersValid:{fn:l.maxUsersValid,message:"{{Invalid number of users.}}",display:"onBlur"},dynamicRange:{fn:function(y,x){if(!y){return true}var v=parseInt(y,10),w=x[0],u=x[1];return v>=w&&v<=u},message:"{{Value is out of range ({0}-{1}).}}",display:"dynamic"},smbUsernameValid:{fn:t(/^[a-zA-Z0-9\-_]+$/),message:"{{Username can include letters, numbers, -, and _.}}",display:"dynamic"},smbPasswordValid:{fn:t(/^[a-zA-Z0-9]+$/),message:"{{Password can include letters and numbers.}}",display:"dynamic"}};k.blockedDomainMaxLength=i(k.maxLength,function(u){return u.maxRuleBlockedURLLength});k.guestPasswordMaxLength=i(k.maxLength,function(u){return u.guestPasswordRestrictions?u.guestPasswordRestrictions.maxLength:null});k.guestPasswordMinLength=i(k.minLength,function(u){return u.guestPasswordRestrictions?u.guestPasswordRestrictions.minLength:null});k.leaseTimeMax=i(k.max,function(u){return u.maxAllowedDHCPLeaseMinutes});k.leaseTimeMin=i(k.min,function(u){return u.minAllowedDHCPLeaseMinutes});k.firstPortValid=r("firstPort");k.lastPortValid=r("lastPort");k.firstExternalPortValid=r("firstExternalPort");k.lastExternalPortValid=r("lastExternalPort");k.firstTriggerPortValid=r("firstTriggerPort");k.lastTriggerPortValid=r("lastTriggerPort");k.firstForwardedPortValid=r("firstForwardedPort");k.lastForwardedPortValid=r("lastForwardedPort");var d={wepPassphraseRules:{maxLength:16,ascii:true},wepKey64:{required:true,hex:true,maxLength:10,minLength:10},wepKey128:{required:true,hex:true,maxLength:26,minLength:26},wpaPassphrase:{required:true,minLength:8,maxLength:63,noSurroundWhitespace:true,ascii:true},wpaPassphraseHex:{minLength:64,maxLength:64,noSurroundWhitespace:true,hex:true},radiusSharedKey:{required:true,ascii:true},cloudAccountLastName:{required:true,noSurroundWhitespace:true,minLength:1,maxLength:128},cloudAccountFirstName:{required:true,noSurroundWhitespace:true,minLength:1,maxLength:128},cloudAccountName:{required:true,minLength:7,maxLength:254,email:true,noSurroundWhitespace:true},cloudAccountPassword:{required:true,minLength:6,maxLength:128,ascii:true,noSurroundWhitespace:true},adminPassword:{required:true,maxLength:64,ascii:true,noSurroundWhitespace:true},applicationName:{required:true,noSurroundWhitespace:true},ipOctet:{min:0,max:255,integer:true},ipAddress:{noSurroundWhitespace:true,ipAddressHasFourOctets:true,ipAddress1stOctet:true,ipAddress2ndOctet:true,ipAddress3rdOctet:true,ipAddress4thOctet:true,ipAddressNotReserved:true,ipAddressPattern:true},ipAddressRouter:{noSurroundWhitespace:true,ipAddressHasFourOctets:true,ipAddress1stOctetRouter:true,ipAddress2ndOctet:true,ipAddress3rdOctet:true,ipAddress4thOctet:true,ipAddressNotReserved:true,ipAddressPattern:true},port:{required:true,integer:true,min:1,max:65535,maxLength:5},deviceName:{required:true,maxLength:255},maxIdleMinutes:{integer:true,min:1,max:9999,maxLength:4},reconnectAfterSeconds:{integer:true,min:20,max:180,maxLength:3},pppoeUsername:{required:true,maxLength:255,ascii:true,noSurroundWhitespace:true},pppoePassword:{maxLength:255,ascii:true},subnetMaskRequired:{required:true,subnetMask:true,ipAddressHasFourOctets:true,noSurroundWhitespace:true,subnet1stOctet:true,subnet2ndOctet:true,subnet3rdOctet:true,subnet4thOctet:true},macAddressRequired:{required:true,macAddress:true},vlanID:{maxLength:4,integer:true,vlanIDValid:true},smbUsername:{required:true,maxLength:20,smbUsernameValid:true},smbPassword:{required:true,minLength:4,maxLength:64,smbPasswordValid:true}};d.cloudAccountCreateNewPassword=h.extend(true,{},d.cloudAccountPassword,{minLength:8});d.radiusServer=h.extend(true,{},d.ipAddress,{required:true});d.ipAddressRequired=h.extend(true,{},d.ipAddress,{required:true});var j={wirelessSecurity:function(u){return{wirelessSecurityTestMode:u,wirelessSecurityTestChannelWidth:u}},networkMode:function(u){return{networkModeTestSecurity:u,networkModeTestChannelWidth:u}},channelWidth:function(u){return{channelWidthTestMode:u,channelWidthTestChannel:u,channelWidthTestSecurity:u}},channel:function(u){return{channelTestWidth:u}},ssid:function(u){return{required:true,noSurroundWhitespace:true,ssidTestNoCollision:u}},guestSsid:function(u){return{required:true,noSurroundWhitespace:true,guestSsidTestNoCollision:u}},guestPassword:function(u){return{required:true,guestPasswordMaxLength:u,guestPasswordMinLength:u,guestPasswordAllowedCharacters:u}},rangeFirstPort:function(u){return h.extend(true,{},d.port,{rangeFirstPortValid:u})},rangeLastPort:function(u){return h.extend(true,{},d.port,{rangeLastPortValid:u})},ipAddressLocal:function(u){return h.extend(true,{},d.ipAddress,{ipAddressLocalTestSubnetMask:u,ipAddressLocalNotRouterIp:u})},lanSettingsIpAddress:function(u){return h.extend(true,{},d.ipAddressRouter,{required:true,ipAddressLocalTestSubnetMask:u})},maxUsers:function(u){return{required:true,integer:true,min:1,maxUsersValid:u}},leaseTime:function(u){return{required:true,integer:true,leaseTimeMax:u,leaseTimeMin:u}},blockedDomain:function(u){return{blockedDomainMaxLength:u,noSurroundDot:true,domainCharsOnly:true,dotRequired:true}},requiredDomain:function(u){return{required:true,maxLength:u,noSurroundDot:true,domainCharsOnly:true,dotRequired:true}},mtu:function(u){return{integer:true,mtuValid:u}}};j.firstPort=g("firstPort");j.lastPort=g("lastPort");j.firstExternalPort=g("firstExternalPort");j.lastExternalPort=g("lastExternalPort");j.firstTriggerPort=g("firstTriggerPort");j.lastTriggerPort=g("lastTriggerPort");j.firstForwardedPort=g("firstForwardedPort");j.lastForwardedPort=g("lastForwardedPort");function s(v,w,u){w=w||0;u=u||255;return function(y){if(!y){return true}var x=y.split(".");if(x.length<=v){return true}if(!x[v]){return x.length===v+1}return k.integer.fn(x[v])&&k.min.fn(x[v],w)&&k.max.fn(x[v],u)}}function e(x,u){var w=(x&u)>>>0,v=(~u|w)>>>0;return x!==w&&x!==v}function b(w,z,y){var v=q.ip.ipToNum(w),A=q.ip.ipToNum(z),x=q.ip.ipToNum(y),u=(v&x)>>>0,B=(A&x)>>>0;return(u===B)&&e(v,x)}function a(u){return function(w){var v;if(!w){return true}w=q.parentalControls.trimBlockedDomain(w);for(v=0;v<u.length;v++){if(w.indexOf(u[v])!==-1){return false}}return true}}function i(v,u){return h.extend(true,{},v,{fn:function(x,w){return v.fn(x,u(w)||"")},message:function(w){return q.stringFormat(v.message,u(w))}})}function r(v){var u,w;if(v.indexOf("first")>-1){u=k.rangeFirstPortValid;w=v.replace("first","last")}else{if(v.indexOf("last")>-1){u=k.rangeLastPortValid;w=v.replace("last","first")}else{throw"incorrect port range field"}}return i(u,function(x){return x[w]})}function g(u){return function(v){var w={};w[u+"Valid"]=v;return h.extend(true,{},d.port,w)}}var p={rule:k,ruleSet:d,ruleSetInterop:j};return p}));