(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","lodash","md5","./symmetry-jnap"],b)}else{if(typeof module==="object"&&module.exports){module.exports=b(require("jquery"),require("lodash"),require("blueimp-md5"),require("./symmetry-jnap"))}else{a.utilWireless=b(a.$,(a.lodash||a._),a.md5,a.JNAP)}}}(this,function(f,x,e,o){var q;var l=["supportedBandSteeringModes"];var c=[{modelNumbers:["EA9200","EA9300","EA9400","EA9500"],supportedModes:[{mode:"Basic",primaryRadioID:"RADIO_5GHz"}],radioDefaults:[{radioID:"RADIO_5GHz",steeredModes:["Basic"],settings:{mode:"802.11anac",channel:36,channelWidth:"Wide80"}},{radioID:"RADIO_5GHz_2",steeredModes:["Basic"],settings:{mode:"802.11anac",channel:161,channelWidth:"Wide80"}}]},{modelNumbers:["EA8300","EA8250"],supportedModes:[{mode:"Basic",primaryRadioID:"RADIO_5GHz"},{mode:"TriBand",primaryRadioID:"RADIO_2.4GHz"}],radioDefaults:[{radioID:"RADIO_2.4GHz",steeredModes:["TriBand"],settings:{mode:"802.11bgn",channel:6,channelWidth:"Standard"}},{radioID:"RADIO_5GHz",steeredModes:["Basic","TriBand"],settings:{mode:"802.11anac",channel:36,channelWidth:"Wide80"}},{radioID:"RADIO_5GHz_2",steeredModes:["Basic","TriBand"],settings:{mode:"802.11anac",channel:161,channelWidth:"Wide80"}}]}];var w=[{channel:1,frequency:"2.412",dfs:false},{channel:2,frequency:"2.417",dfs:false},{channel:3,frequency:"2.422",dfs:false},{channel:4,frequency:"2.427",dfs:false},{channel:5,frequency:"2.432",dfs:false},{channel:6,frequency:"2.437",dfs:false},{channel:7,frequency:"2.442",dfs:false},{channel:8,frequency:"2.447",dfs:false},{channel:9,frequency:"2.452",dfs:false},{channel:10,frequency:"2.457",dfs:false},{channel:11,frequency:"2.462",dfs:false},{channel:12,frequency:"2.467",dfs:false},{channel:13,frequency:"2.472",dfs:false},{channel:14,frequency:"2.484",dfs:false},{channel:34,frequency:"5.170",dfs:false},{channel:36,frequency:"5.180",dfs:false},{channel:38,frequency:"5.190",dfs:false},{channel:40,frequency:"5.200",dfs:false},{channel:42,frequency:"5.210",dfs:false},{channel:44,frequency:"5.220",dfs:false},{channel:46,frequency:"5.230",dfs:false},{channel:48,frequency:"5.240",dfs:false},{channel:50,frequency:"5.250",dfs:true},{channel:52,frequency:"5.260",dfs:true},{channel:54,frequency:"5.270",dfs:true},{channel:56,frequency:"5.280",dfs:true},{channel:58,frequency:"5.290",dfs:true},{channel:60,frequency:"5.300",dfs:true},{channel:62,frequency:"5.310",dfs:true},{channel:64,frequency:"5.320",dfs:true},{channel:100,frequency:"5.500",dfs:true},{channel:102,frequency:"5.510",dfs:true},{channel:104,frequency:"5.520",dfs:true},{channel:106,frequency:"5.530",dfs:true},{channel:108,frequency:"5.540",dfs:true},{channel:110,frequency:"5.550",dfs:true},{channel:112,frequency:"5.560",dfs:true},{channel:114,frequency:"5.570",dfs:true},{channel:116,frequency:"5.580",dfs:true},{channel:118,frequency:"5.590",dfs:true},{channel:120,frequency:"5.600",dfs:true},{channel:122,frequency:"5.610",dfs:true},{channel:124,frequency:"5.620",dfs:true},{channel:126,frequency:"5.630",dfs:true},{channel:128,frequency:"5.640",dfs:true},{channel:132,frequency:"5.660",dfs:true},{channel:134,frequency:"5.670",dfs:true},{channel:136,frequency:"5.680",dfs:true},{channel:138,frequency:"5.690",dfs:true},{channel:140,frequency:"5.700",dfs:true},{channel:142,frequency:"5.710",dfs:true},{channel:144,frequency:"5.720",dfs:true},{channel:149,frequency:"5.745",dfs:false},{channel:153,frequency:"5.765",dfs:false},{channel:157,frequency:"5.785",dfs:false},{channel:161,frequency:"5.805",dfs:false},{channel:165,frequency:"5.825",dfs:false},{channel:184,frequency:"4.920",dfs:false},{channel:188,frequency:"4.940",dfs:false},{channel:192,frequency:"4.960",dfs:false},{channel:196,frequency:"4.980",dfs:false}];var r=["WPA2/WPA3-Mixed-Personal","WPA-Mixed-Personal","WPA3-Personal","WPA2-Personal","WPA-Personal","WPA3-Enterprise","WPA2-Enterprise","WPA-Enterprise","WPA-Mixed-Enterprise","Enhanced-Open","Enhanced-Open-Only","Enhanced-Open+None","WEP","None"];function h(D,E,B){E=E||"";if(o.isServiceSupported("/wirelessap/WirelessAP4")){D=Number(D);var H=f.inArray(D,f.grep(B.supportedChannelsForChannelWidths,function(I){return I.channelWidth===E})[0].channels);return H!==-1}var A=B.supportedChannels.indexOf(D)>-1;var F=B.supportedWideChannels.indexOf(D)>-1;var z=!(E==="Auto"&&(!A||!F));var G=!(E==="Standard"&&!A);var C=!(t(E)&&!F);return z&&G&&C}function t(z){return z.indexOf("Wide")!==-1}function v(z){return z==="Wide80"||z.indexOf("Wide160")!==-1}function g(C,z){var A=z.band,D=z.supportedModes,B=false;if(D.indexOf("802.11mixed")!==-1){if(C==="802.11mixed"){B=true}}else{if(D.indexOf("802.11anac")!==-1&&D.indexOf("802.11anacax")===-1){if(C==="802.11bgn"){B=true}else{if(C==="802.11anac"){B=true}}}else{if(A==="2.4GHz"){if(D.indexOf("802.11bgnax")!==-1){if(C==="802.11bgnax"){B=true}}else{if(C==="802.11bgn"){B=true}}}else{if(A==="5GHz"){if(D.indexOf("802.11anacax")!==-1){if(C==="802.11anacax"){B=true}}else{if(C==="802.11an"){B=true}}}}}}return B}function y(){var z=x.find(c,function(A){return A.modelNumbers.indexOf(o.cache.data["/core/GetDeviceInfo"].output.modelNumber)!==-1});if(o.isServiceSupported("/wirelessap/bandsteering/AutoChannelConfiguration")){z.radioDefaults.forEach(function(A){A.settings.channel=0;A.settings.channelWidth="Auto"})}return z}function k(C,A){var z=y(),B=x.find(x.result(z,"supportedModes"),{mode:x.result(C,"bandSteeringMode")});return A.radioID===x.result(B,"primaryRadioID")}function d(z){return z.radioID.lastIndexOf("_2")===z.radioID.length-2}function n(){var A=o.Deferred(),B,z;o.send("/wirelessap/GetRadioInfo",{}).success(function(C){B=x.cloneDeep(C.output);B.radios=x.sortBy(B.radios,"radioID");if(B.supportedBandSteeringModes){z=y()}B.radios.forEach(function(D){D.isSetToMixedMode=g(D.settings.mode,D);D.supportedSecurityTypes=j(D.supportedSecurityTypes);if(z){D.bandSteeringSettings=x.find(z.radioDefaults,{radioID:D.radioID})||{}}});A.resolve(B)}).error(function(C){A.reject(C)});return A}function a(z){return{radioID:z.radioID,settings:z.settings}}function p(G,C,D){var H=o.Deferred(),B=x.cloneDeep(x.omit(G,l)),J=o.transaction(),A,z,I=[],F,E=false;B.radios.forEach(function(L,K){if(B.isBandSteeringEnabled){if(x.includes(x.result(L,"bandSteeringSettings.steeredModes"),G.bandSteeringMode)){L.settings=x.merge(L.settings,L.bandSteeringSettings.settings);if(k(G,L)){z=a(L)}else{I.push(L.radioID)}}}if(!E&&o.isFeatureSupported("Node")&&x.isEmpty(L.supportedChannelsForChannelWidths)){E=true}B.radios[K]=a(L)});if(!G.isBandSteeringEnabled){B=x.omit(B,"bandSteeringMode")}else{if(z&&I.length){I.forEach(function(K){F=x.findIndex(B.radios,{radioID:K});A=x.cloneDeep(B.radios[F]);B.radios[F]=x.merge(B.radios[F],z);B.radios[F].radioID=A.radioID;B.radios[F].settings.channel=A.settings.channel;B.radios[F].settings.mode=A.settings.mode;B.radios[F].settings.channelWidth=A.settings.channelWidth;if(!h(A.settings.channel,A.settings.channelWidth,G.radios[F])){B.radios[F].settings.channel=0}})}}J.add("/wirelessap/SetRadioSettings",B);q.guestAccess.checkAndConfigureGuestAccess(C,G,J);q.wps.checkAndDisableWPS(D.enabled,null,G,J);J.send({disableFeatureDetection:E}).success(function(){H.resolve(B)}).error(function(K){H.reject(K)});return H}function b(B,D){var A=[],C,z;D=x.isEmpty(D)?"":D;if(B==="WEP-64"){z=Array.prototype.reduce.call(D,function(F,G,E){return F^=G.charCodeAt()<<E%4*8},0);x.range(0,4).forEach(function(){C="";x.range(0,5).forEach(function(){z*=214013;z+=2531011;z&=4294967295;C+=("0"+(z>>16&255).toString(16)).slice(-2).toUpperCase()});A.push(C)})}else{if(B==="WEP-128"){z=x.reduce(x.range(0,64),function(F,E){return F+D.charAt(E%D.length)},"");C=e(z).slice(0,26).toUpperCase();x.range(0,4).forEach(function(){A.push(C)})}else{throw'Unknown encryption specified. Needs to be "WEP-64" or "WEP-128"'}}return A}function j(z){return x.intersection(r,z)}function s(D,C){var z=q.time.routerTimeToDate(C),B=q.time.getDayFromSchedule(D.wirelessSchedule,z),A=z.getHours()*2;if(D.isWirelessSchedulerEnabled&&B[A]==="0"){return true}return false}function m(z){z=parseInt(z);return x.find(w,{channel:z})||{}}function u(z){z=parseFloat(z).toPrecision(4);return x.find(w,{frequency:z})||{}}function i(){var z=o.Deferred();z.resolve();return z}return function(z){q=z;return{isMixedMode:g,isWideChannel:t,isWideChannel80or160:v,isChannelAndWidthSupported:h,isPrimaryBandSteeredRadio:k,isSecondaryBandRadio:d,isWirelessDisabledBySchedule:s,checkForSSIDCollision:i,getWirelessSettings:n,setWirelessSettings:p,getBandSteeringSettings:y,generateWEPKeys:b,lookupChannelDataByChannel:m,lookupChannelDataByFrequency:u,getSecurityTypeOrder:j}}}));