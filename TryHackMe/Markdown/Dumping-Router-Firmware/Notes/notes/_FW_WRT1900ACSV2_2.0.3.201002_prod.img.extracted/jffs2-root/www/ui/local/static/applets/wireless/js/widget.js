(function(){var c=$("#wireless.widget"),m=1,j;function h(q){q=q||"";if($(this).hasClass("disabled")){return false}var p=RAINIER.connect.AppletManager.getAppletById("7B1F462B-1A78-4AF6-8FBB-0C221703BEA4");if(p){RAINIER.ui.MainMenu.launchApplet(p,q)}else{console.warn("Widget: cannot locate Wireless applet")}}function b(){var p=$(this),q=p.parent().siblings();if(!q.is(":visible")){c.find(".collapsedPassword").hide();c.find(".ssidLabel").removeClass("ssidLabelActive");q.show();p.addClass("ssidLabelActive")}else{p.removeClass("ssidLabelActive");q.hide()}}function e(r){if(RAINIER.network.isBehindNode()&&window.location.hash!=="#casupport"){var p=_.find(r,{radioID:"RADIO_2.4GHz"}),q=_.find(r,{radioID:"RADIO_5GHz"});if(RAINIER.applets.wireless.areAllRadioSettingsIdentical(r)){return[p]}else{return[p,q]}}return r}function k(){var q=c.find("#radiosDisplay"),p;q.empty();RAINIER.applets.wireless.sortRadios(j.radios);p=e(j.radios);j.combineNetworks=p.length===1;p.forEach(function(s,r){if(RAINIER.applets.wireless.shouldFilterRadio(s,j)){var t=c.find("#radioTemplate").clone(),u=RAINIER.shared.util.getLabeledRadio(j,s.radioID);u.radioIDTemplate=s.radioID.replace(".","");t.attr("id",u.radioIDTemplate);if(r===0){t.find(".radioDisplay").addClass("first")}q.append(t);g(u);o(u);a(u);i(u);n(u);RAINIER.binder.toDom(u,c.find("#"+u.radioIDTemplate),{})}});if(j.bandSteeringMode==="TriBand"){q.addClass("triBandSteeringMode")}else{q.removeClass("triBandSteeringMode")}c.find(".app-link").click(function(){h("")});c.find(".wfs-icon, .active-wfs-icon").click(function(){h("scheduler")});c.find(".ssidLabel").click(b);RAINIER.ui.tooltip.add(c.find("[tooltip]"),"top")}function n(q){var p=c.find("#"+q.radioIDTemplate+" .ssidLabel"),r=217;switch(m){case 2:r=199;break;case 3:r=181;break}if(!j.isBandSteeringEnabled||q.radioID!=="RADIO_5GHz"){r=(r-c.find("#"+q.radioIDTemplate+" .bandInfo").outerWidth(true))}else{c.find("#"+q.radioIDTemplate+" .bandInfo").css("margin-top",5)}p.css("max-width",r);m=1}function g(p){if(["None","Enhanced-Open","Enhanced-Open-Only","Enhanced-Open+None"].indexOf(p.settings.security)>-1){c.find("#"+p.radioIDTemplate+" .radioIcons .unlock-icon").css("display","inline");c.find("#"+p.radioIDTemplate+" .collapsedPassword .password").addClass("unsecured");p.settings.password=RAINIER.ui.common.strings.wirelessSecurity.None}else{d(p);c.find("#"+p.radioIDTemplate+" .radioIcons .lock-icon").css("display","inline")}}function d(p){if(p.settings.security==="WEP"){p.settings.password=p.settings.wepSettings["key"+p.settings.wepSettings.txKey]}else{if(p.settings.security==="WPA-Enterprise"||p.settings.security==="WPA2-Enterprise"||p.settings.security==="WPA-Mixed-Enterprise"){p.settings.password=p.settings.wpaEnterpriseSettings.sharedKey}else{p.settings.password=p.settings.wpaPersonalSettings.passphrase}}}function o(p){if(!p.settings.isEnabled){c.find("#"+p.radioIDTemplate+" .radioDisplay").addClass("disabledSSID")}if(!p.settings.broadcastSSID){c.find("#"+p.radioIDTemplate+" .radioIcons .eye-icon").css("display","inline");m++}}function a(q){if(RAINIER.network.isWirelessSchedulerEnabled()){var p="wfs-icon";RAINIER.network.areRadiosDisabledByWFS(function(r){if(r){c.find("#"+q.radioIDTemplate+" .radioDisplay").addClass("disabledSSID");c.find("#"+q.radioIDTemplate+" .radioIcons ."+p).css("display","none");p="active-"+p}c.find("#"+q.radioIDTemplate+" .radioIcons ."+p).css("display","inline")});m++}}function i(p){c.find("#"+p.radioIDTemplate+" .bandInfo").html(p.labels["short"])}function f(){RAINIER.jnap.send({action:RAINIER.jnapActions.getRadioInfo(),data:{},cb:function(p){if(p.result==="OK"){j=p.output;k()}else{}}})}function l(){f();RAINIER.event.connect("wireless.updated",function(p,q){if(q){j=$.extend(true,{},q);k()}else{f()}})}l()}());