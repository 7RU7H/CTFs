(function(){var i=[],d={},g=RAINIER.shared.util.getCookie("user-auth-token"),a=RAINIER.shared.util.getCurrentNetworkID();function b(m,l){for(var k=0;k<m.deviceRules.length;k++){if(l===m.deviceRules[k].macAddress){return true}}return false}function e(k){var l=document.getElementById("notLoading");if(l){l.style.display=(k==="loading"?"none":"block")}showView(k)}function j(){window.location="login-simple.html"}function f(){for(var l=0;l<i.length;l++){var q=i[l].network;if(i[l].devices){for(var k=0;k<i[l].devices.length;k++){var o=i[l].devices[k].device;var s="media-prioritization.html?networkId="+q.networkId+"&email="+encodeURIComponent(d)+"&locale=en-US&deviceId="+encodeURIComponent(o.deviceID);var m=document.getElementsByClass("testLinks");if(m.length===1){var r=document.createElement("p");var n=document.createElement("a");n.href=s;n.appendChild(document.createTextNode(o.friendlyName+" - "+q.friendlyName+(b(i[l].qosSettings,o.knownMACAddresses[0])?" (prioritized)":"")));r.appendChild(n);m[0].appendChild(r)}}}}RAINIER.shared.util.setCurrentNetworkID(a);e("testing")}function h(k){RAINIER.shared.util.setCurrentNetworkID(i[k].network.networkId);var l=RAINIER.jnap.Transaction({remote:true,disableDefaultAjaxErrHandler:true,disableDefaultJnapErrHandler:true,onComplete:function(){if(k<i.length-1){h(k+1)}else{f()}}});l.add({action:"/jnap/devicelist/GetDevices",data:{},cb:function(p){if(p.result==="OK"){i[k].devices=[];for(var m=0;m<p.output.devices.length;m++){var n=p.output.devices[m];if(!n.isAuthority){i[k].devices.push({device:n})}}}}});l.add({action:"/jnap/qos/GetQoSSettings",data:{},cb:function(m){if(m.result==="OK"){i[k].qosSettings=m.output}}});l.send()}function c(){RAINIER.cloud.send({url:"/cloud/device-service/rest/accounts/self/networks",type:"GET",request:{},cb:function(l){for(var k=0;k<l.networkAccountAssociations.length;k++){i.push({network:l.networkAccountAssociations[k].networkAccountAssociation.network})}if(a==="null"){RAINIER.shared.util.setCurrentNetworkID(i[0].network.networkId)}RAINIER.cloud.send({url:"/cloud/device-service/rest/networks/"+i[0].network.networkId,type:"GET",request:{},cb:function(m){d=m.network.owner.username;h(0)},cbError:function(){showView("error")}})},cbError:function(k){if(k.status===401){j()}else{showView("error")}}})}window.onload=function(){if(typeof g==="undefined"){j();return}showView("loading");c()}}());