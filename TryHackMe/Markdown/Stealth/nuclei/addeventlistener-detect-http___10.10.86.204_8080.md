### DOM EventListener - Cross-Site Scripting (addeventlistener-detect) found on 10.10.86.204:8080

----
**Details**: **addeventlistener-detect** matched at 10.10.86.204:8080

**Protocol**: HTTP

**Full URL**: http://10.10.86.204:8080

**Timestamp**: Wed Jan 10 17:21:50 +0000 GMT 2024

**Template Information**

| Key | Value |
| --- | --- |
| Name | DOM EventListener - Cross-Site Scripting |
| Authors | yavolo, dwisiswant0 |
| Tags | xss, misc |
| Severity | info |
| Description | EventListener contains a cross-site scripting vulnerability via the document object model (DOM). An attacker can execute arbitrary script which can then allow theft of cookie-based authentication credentials and launch of  other attacks. |
| CVSS-Metrics | [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N) |
| CWE-ID | [CWE-79](https://cwe.mitre.org/data/definitions/79.html) |
| CVSS-Score | 7.20 |

**Request**
```http
GET / HTTP/1.1
Host: 10.10.86.204:8080
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2866.71 Safari/537.36
Connection: close
Accept: */*
Accept-Language: en
Accept-Encoding: gzip


```

**Response**
```http
HTTP/1.1 200 OK
Connection: close
Content-Length: 2140
Content-Type: text/html; charset=UTF-8
Date: Wed, 10 Jan 2024 17:21:44 GMT
Server: Apache/2.4.56 (Win64) OpenSSL/1.1.1t PHP/8.0.28
X-Powered-By: PHP/8.0.28

<!DOCTYPE html>
<html>
<head>
  <title>PowerShell Script Analyser</title>
  <style>
	@import url("font.css");
    body {
	  height: 100vh;
      font-family: "Ubuntu", "Source Sans Pro", sans-serif !important;
      margin: 0;
      padding: 0;
      background-color: #f2f2f2;
      background-image: url('background-image.jpg');
	  background-repeat:no-repeat;
      background-size: cover;
      background-position: center;
    }
	
	.container-box {
		padding: 35px 0;
	}
    
    .container {
      max-width: 500px;
		margin: 0 auto;
		padding: 20px;
		box-shadow: 2px 2px 20px rgba(0, 0, 0);
		border-radius: 6px;
		background-color: #dddddd;
	}
    
    h1 {
      margin-top: 0;
      margin-bottom: 20px;
      color: #333;
      text-align: center;
    }
    
    form {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    input[type="file"] {
      margin-bottom: 10px;
    }
    
    button[type="submit"] {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 50px;
	  cursor: pointer;
      border-radius: 4px;
    }
    
    button[type="submit"]:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
	<div class="container-box">
	  <div class="container">
		<h1>PowerShell Script Analyser</h1>
				
		
		<form action="" method="POST" enctype="multipart/form-data">
		  <input type="file" name="fileInput">
		  <button type="submit" name="uploadButton">Upload</button>
		  <p style="margin-bottom: 0;">
		  Please upload any .ps1 PowerShell script to see if it is malicious or not (Dev Mode). The tool is in dev-mode and only allow .ps1 format at this stage.				</p>
		</form>
	  </div>
	 </div>
  
  <script>
    // Optional: You can use JavaScript to show a message after the file is uploaded
    const form = document.querySelector('form');
    
    form.addEventListener('submit', () => {
      setTimeout(() => {
        alert('File uploaded successfully!');
      }, 3000); // 3 seconds delay
    });
  </script>
</body>
</html>

```

References: 
- https://portswigger.net/web-security/dom-based/controlling-the-web-message-source

**CURL command**
```sh
curl -X 'GET' -H 'Accept: */*' -H 'Accept-Language: en' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2866.71 Safari/537.36' 'http://10.10.86.204:8080'
```

----

Generated by [Nuclei v3.1.1](https://github.com/projectdiscovery/nuclei)